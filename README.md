# XW-智能协同云图库平台

## 项目概述

XW-智能协同云图库平台是一款基于 **Vue 3 + Spring Boot + COS + WebSocket** 构建的**企业级智能协同云图库系统**。项目旨在为个人用户、企业团队提供高效的图片存储、管理、检索及协同编辑解决方案，支持公开素材共享与私有空间管理双重模式，可灵活适配表情包网站、设计素材平台、企业内部图库等多场景使用。

作为练习项目，代码仍有优化空间，后续将持续迭代完善核心功能与系统性能。

## 技术栈

### 后端技术

- **核心框架**: Spring Boot（集成Spring MVC、MyBatis）
- **安全与授权**: Sa-Token（用户授权管理）、RDBC权限控制
- **数据库**: MySQL（核心业务数据存储，字符集 `utf8mb4_unicode_ci`）
- **分库分表**: ShardingSphere（数据分片，提升海量图片数据处理能力）
- **缓存技术**:
    - Caffine（本地缓存，优化热点数据访问速度）
    - Redis（分布式缓存，支持会话存储、高频数据缓存）
- **消息队列**: Disruptor（无锁队列，提升高并发场景下的任务处理效率）
- **文件存储**: 腾讯云COS（对象存储服务，存储图片文件及缩略图）
- **实时通信**: WebSocket（支持协同编辑、状态同步等实时交互场景）
- **定时任务**: Spring Task（处理定时审核、数据统计等任务）
- **AI能力**: 集成AI模型（图片分析相关功能支持）
- **其他工具**:
    - 接口文档（默认集成Swagger/Knife4j，便于接口调试）
    - 日志记录（系统操作日志、访问日志管理）

### 前端技术

- **核心框架**: Vue 3（响应式前端网站开发）
- **构建工具**: Vite（前端工程化构建）
- **HTTP客户端**: Axios（前后端接口通信）
- **UI组件库**: Ant Design Vue（适配多端访问）

### 部署与运维

- **接入层**: Vercel（请求转发，优化访问链路）
- **容器化**: Docker（应用打包与环境一致性保障）
- **服务器**: Linux云服务器（提供网络带宽、硬盘存储支持）

## 功能模块

系统核心功能分为**用户端**、**管理端**，并预留**个人私有空间**、**企业团队空间**两大待实现模块，覆盖不同用户群体的使用需求。

### 1. 管理端功能

- **用户管理**: 查看平台注册用户信息，配置用户角色（`user`/`admin`），管理用户账号状态。
- **图片审核**: 处理用户上传的图片审核请求（待审核/审核通过/审核拒绝），填写审核拒绝原因，记录审核人及审核时间。
- **图片管理**: 检索、查看平台所有图片资源，按分类、标签、上传用户等维度筛选，管理图片状态。
- **系统分析**: 对平台图片数据（上传量、分类分布、审核通过率等）进行统计分析，辅助运营决策。

### 2. 用户端功能

- **用户注册/登录**: 通过账号密码完成注册登录，支持个人信息（昵称、头像、简介）编辑。
- **图片上传**: 公开上传图片素材，填写图片名称、介绍、分类、标签等元信息，支持自动生成缩略图。
- **图片检索**: 按图片名称、分类、标签、介绍等维度检索公开图片资源，快速查找所需素材。
- **图片查看**: 查看图片详情（尺寸、格式、大小、上传时间等），访问图片原始链接及缩略图链接。

### 3. 待实现功能 - 个人私有空间

- 图片私有化上传与存储，仅本人可见。
- 批量管理私有图片（分类、标签编辑、批量删除、批量导出）。
- 图片在线编辑（尺寸调整、缩放、格式转换等）。
- 私有图片数据分析（存储占用、上传趋势等）。

### 4. 待实现功能 - 企业团队空间

- 开通企业专属团队空间，设置空间权限。
- 邀请成员加入团队，共享团队图片资源。
- 图片协同编辑（多人实时协作修改，状态同步）。
- 团队操作日志记录，追溯图片修改历史。

## 系统架构与设计

### 分层架构设计

![](https://a1.boltp.com/2026/01/13/696615bdcd4c3.png)

### Spring Boot分层

- **Controller层**: 处理HTTP请求，调用Service层处理业务逻辑，返回响应结果。
- **Service层**: 实现业务逻辑，调用Mapper层操作数据库，协调不同模块之间的交互。
- **Mapper层**: 定义数据库操作接口，与MyBatis Plus框架交互，执行SQL语句。
- **Model层**: 定义数据实体类（如User、Picture等），映射数据库表结构。

### 数据库设计

数据库名为 `xw_picture`，核心表结构如下（简化非关键字段）：


| 表名      | 说明   | 核心字段                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| :-------- | :----- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `user`    | 用户表 | id, userAccount (账号，唯一), userPassword (密码), userName (昵称), userAvatar (头像), userProfile (简介), userRole (角色: user/admin), createTime (创建时间), updateTime (更新时间), isDelete (是否删除: 0/1)                                                                                                                                                                                                                                                  |
| `picture` | 图片表 | id, userId (创建用户 id), url (图片 url), thumbnailUrl (缩略图 url), name (图片名称), introduction (介绍), category (分类), tags (标签，JSON 数组逗号分隔), picSize (大小 / 字节), picHeight (高度), picWidth (宽度), picScale (缩放比例), picFormat (格式), reviewStatus (审核状态: 0 待审核 / 1 通过 / 2 拒绝), reviewMessage (审核消息), reviewId (审核人 id), reviewTime (审核时间), createTime (创建时间), updateTime (更新时间), isDelete (是否删除: 0/1) |

#### 索引设计

- `user` 表：
    - 唯一索引 `uk_userAccount_isDelete`（账号 + 删除状态唯一）
    - 普通索引 `idx_userName`（用户名检索）
- `picture` 表：
    - 普通索引 `idx_userId`（用户关联）
    - 普通索引 `idx_name`（图片名称检索）
    - 普通索引 `idx_category`（分类检索）
    - 普通索引 `idx_tags`（标签检索）
    - 普通索引 `idx_introduction`（介绍检索）
    - 普通索引 `idx_reviewStatus`（审核状态检索）

## 环境配置与启动

### 开发环境要求

- JDK 11+
- MySQL 8.0+（支持 utf8mb4 字符集）
- Redis 6.0+（分布式缓存依赖）
- Node.js 16+（前端运行环境）
- Maven 3.6+（后端项目构建）
- Mybatis Plus 3.5+ （数据库操作框架）
- 腾讯云 COS 账号（配置对象存储权限）
- Docker（可选，容器化部署）

### 数据库初始化

1. 新建 MySQL 数据库，命名为 `xw_picture`。
2. 执行项目提供的 `create_table.sql` 脚本，初始化表结构及索引。
3. 修改后端配置文件 `application.yml` 中的数据库连接信息：

```yaml
spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://你的主机:端口/xw_picture?serverTimezone=Asia/Shanghai&useUnicode=true&characterEncoding=utf8mb4&zeroDateTimeBehavior=convertToNull&useSSL=false&allowPublicKeyRetrieval=true
    username: 你的用户名
    password: 你的密码
```

#### Redis 配置

```yaml
spring:
  redis:
    host: localhost
    port: 6379
    password: # 若有密码请填写
    database: 0
```

### 项目启动步骤

#### 后端启动 (xw-picture-backend)

1. 克隆项目到本地。
2. 进入后端目录: `cd xw-picture-backend`。
3. 编译并启动: `mvn spring-boot:run`。
4. 访问接口文档: `http://localhost:8123/api/doc.html` （若集成 Swagger/Knife4j）。

#### 前端启动 (xw-picture-front)

1. 进入前端目录: `cd xw-picture-frontend`。
2. 安装依赖: `npm install`。
3. 启动开发环境: `npm run dev`。
4. 访问前端页面: `http://localhost:5173`（默认 Vite 启动端口）。

### 项目特色与亮点

- 多场景适配：支持公开素材共享、个人私有存储、企业协同编辑，覆盖个人与企业用户需求。
- 高性能架构：集成 Caffine 本地缓存、Redis 分布式缓存、Disruptor 无锁队列，优化高并发场景下的响应速度；ShardingSphere 分库分表支持海量图片数据存储。
- 完善的审核机制：图片上传后需经过审核流程，支持审核状态跟踪、审核日志记录，保障平台内容合规。
- 多维度检索：支持图片名称、分类、标签、介绍等多维度检索，结合索引设计提升查询效率。
- 实时协同能力：基于 WebSocket 实现团队协同编辑，状态实时同步，提升团队协作效率。
- 灵活的存储方案：采用腾讯云 COS 存储图片及缩略图，支持大文件存储与高速访问，降低本地存储压力。
- 安全可靠：基于 Sa-Token 实现用户授权管理，账号密码加密存储，图片访问权限控制，保障数据安全。

### 注意事项

- 开发环境需确保 MySQL、Redis 服务已启动，否则会导致数据库连接或缓存操作失败。
- 图片标签格式需遵循 JSON 数组逗号分隔规范（如 `["风景","壁纸"]`），否则可能影响检索功能。
- 腾讯云 COS 需提前开通存储桶并配置访问权限，确保 AccessKey 拥有上传、下载权限。
- 生产环境部署时，需关闭接口文档、隐藏敏感配置（如数据库密码、COS 密钥），开启 HTTPS 提升安全性。
- 待实现功能（个人私有空间、企业协同编辑）需后续扩展开发，当前版本仅支持核心功能。
- 数据库索引已优化常用检索场景，新增检索维度时需同步添加对应索引，避免性能瓶颈。

### 参与贡献

1. Fork 本仓库。
2. 创建特性分支: `git checkout -b feature/xxx`（如 `feature/private-space`）。
3. 提交修改: `git commit -m '实现xxx功能'`。
4. 推送分支: `git push origin feature/xxx`。
5. 提交 Pull Request。

### 联系方式

- 项目维护者: XW
- 项目链接: [XW - 智能协同云图库平台](https://picture.xwybq.top/#/)
- 作者主页: [XW](https://www.xwybq.top/about/)
- 问题反馈：请在 GitHub Issues 提交，或联系邮箱: [w3290819205@gmail.com](mailto:w3290819205@gmail.com)
